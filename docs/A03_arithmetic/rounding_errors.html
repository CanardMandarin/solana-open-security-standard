<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-A03_arithmetic/rounding_errors">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.1">
<title data-rh="true">Rounding Errors | Solana Open Security Standard (SOSS)</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://solana-open-security-standard.github.io/solana-open-security-standard/img/banner.jpg"><meta data-rh="true" name="twitter:image" content="https://solana-open-security-standard.github.io/solana-open-security-standard/img/banner.jpg"><meta data-rh="true" property="og:url" content="https://solana-open-security-standard.github.io/solana-open-security-standard/docs/A03_arithmetic/rounding_errors"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Rounding Errors | Solana Open Security Standard (SOSS)"><meta data-rh="true" name="description" content="Learn how to prevent &quot;Rounding Errors&quot; in Solana programs. Rounding errors occur in approximate arithmetic when calculations are performed with limited precision, leading to small discrepancies that can accumulate and impact the accuracy of computations."><meta data-rh="true" property="og:description" content="Learn how to prevent &quot;Rounding Errors&quot; in Solana programs. Rounding errors occur in approximate arithmetic when calculations are performed with limited precision, leading to small discrepancies that can accumulate and impact the accuracy of computations."><meta data-rh="true" name="keywords" content="Rounding Errors,Solana programs,approximate arithmetic,numerical precision,rounding techniques,cumulative errors,Solana vulnerability"><link data-rh="true" rel="icon" href="/solana-open-security-standard/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://solana-open-security-standard.github.io/solana-open-security-standard/docs/A03_arithmetic/rounding_errors"><link data-rh="true" rel="alternate" href="https://solana-open-security-standard.github.io/solana-open-security-standard/docs/A03_arithmetic/rounding_errors" hreflang="en"><link data-rh="true" rel="alternate" href="https://solana-open-security-standard.github.io/solana-open-security-standard/docs/A03_arithmetic/rounding_errors" hreflang="x-default"><link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","G-S919WHVGV9","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><link rel="stylesheet" href="/solana-open-security-standard/assets/css/styles.ab1e4997.css">
<link rel="preload" href="/solana-open-security-standard/assets/js/runtime~main.b0fbbdeb.js" as="script">
<link rel="preload" href="/solana-open-security-standard/assets/js/main.e4e199ec.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/solana-open-security-standard/"><div class="navbar__logo"><img src="/solana-open-security-standard/img/logo.png" alt="Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/solana-open-security-standard/img/logo.png" alt="Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/CanardMandarin/solana-open-security-standard" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/methodology">Methodology</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/call_for_data">Call For Data</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1"><hr></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-open-security-standard/docs/A01_logic_bug">A01 - Logic Bug</a><button aria-label="Toggle the collapsible sidebar category &#x27;A01 - Logic Bug&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/solana-open-security-standard/docs/A02_account_validation">A02 - Account Validation</a><button aria-label="Toggle the collapsible sidebar category &#x27;A02 - Account Validation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/solana-open-security-standard/docs/A03_arithmetic">A03 - Arithmetic</a><button aria-label="Toggle the collapsible sidebar category &#x27;A03 - Arithmetic&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/solana-open-security-standard/docs/A03_arithmetic/integer_overflow">Integer Overflow &amp; Underflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/solana-open-security-standard/docs/A03_arithmetic/rounding_errors">Rounding Errors</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/A04_code_quality">A04 - Code quality</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/A05_dependencies">A05 - Dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/solana-open-security-standard/docs/A06_denial_of_service">A06 - Denial of Service</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/solana-open-security-standard/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/solana-open-security-standard/docs/A03_arithmetic"><span itemprop="name">A03 - Arithmetic</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Rounding Errors</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Rounding Errors</h1><p>Rounding errors occur in approximate arithmetic when a calculation is performed using a limited number of digits or precision, leading to an approximation of the exact result. In contrast to exact arithmetic, which yields precise results, approximate arithmetic introduces small discrepancies due to the truncation or rounding of numbers.</p><p>Rounding errors can accumulate and propagate through subsequent calculations, leading to larger discrepancies. In some cases, this can cause significant deviations in the final result, impacting the accuracy of computations.</p><p>Dealing with rounding errors requires careful consideration of numerical precision, appropriate rounding techniques, and, in some cases, using specialized numerical methods or arbitrary precision arithmetic to minimize the impact of these errors.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-prevent">How To Prevent<a href="#how-to-prevent" class="hash-link" aria-label="Direct link to How To Prevent" title="Direct link to How To Prevent">​</a></h2><p>Establishing clear and consistent rounding direction policies is essential. When instructions involve sending tokens to a user, it is generally recommended to round down to the nearest value. This approach ensures that users do not receive more funds than they should, preventing overestimation.</p><p>On the other hand, rounding up is the preferred method in calculations that determine the amount of tokens a user should send. For instance, developers may opt to round up fees computations to guarantee that users always cover the necessary fees, even when dealing with small amounts. </p><p>Minimizing rounding operations is another crucial aspect to prevent errors. Performing rounding only at the final output stage and keeping intermediate values in their full precision can help avoid cumulative errors that may arise from multiple rounding operations. By reducing the number of rounding steps, developers can maintain the accuracy of numerical computations.</p><h1>Reference</h1><ul><li><a href="https://osec.io/blog/2022-04-26-spl-swap-rounding" target="_blank" rel="noopener noreferrer">Ottersec: Becoming a Millionaire, 0.000150 BTC at a Time</a></li><li><a href="https://neodyme.io/blog/lending_disclosure/" target="_blank" rel="noopener noreferrer">Neodyme: How to Become a Millionaire, 0.000001 BTC at a Time</a></li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/CanardMandarin/solana-open-security-standard/tree/main/docs/A03_arithmetic/rounding_errors.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/solana-open-security-standard/docs/A03_arithmetic/integer_overflow"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Integer Overflow &amp; Underflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/solana-open-security-standard/docs/A04_code_quality"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">A04 - Code Quality</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-prevent" class="table-of-contents__link toc-highlight">How To Prevent</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Links</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://solana.stackexchange.com/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/CanardMandarin/solana-open-security-standard" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Solana Open Security Standard</div></div></div></footer></div>
<script src="/solana-open-security-standard/assets/js/runtime~main.b0fbbdeb.js"></script>
<script src="/solana-open-security-standard/assets/js/main.e4e199ec.js"></script>
</body>
</html>